document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".source-selector")&&(initSourceSelector(),initLoadingState()),document.querySelector(".reader-images")&&initImageModal(),document.querySelector(".chapter-list")&&initChapterToggle(),initScrollToTop()});function initLoadingState(){const e=document.querySelector(".source-selector form"),t=document.getElementById("loading-indicator"),o=document.querySelector("main");e&&t&&o&&e.addEventListener("submit",()=>{o.style.display="none",t.style.display="flex"})}function initScrollToTop(){const e=document.getElementById("scrollToTopBtn");e&&(window.addEventListener("scroll",()=>{window.scrollY>300?e.classList.add("show"):e.classList.remove("show")}),e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function initSourceSelector(){const e=document.getElementById("source");e&&e.addEventListener("change",()=>{e.form.submit()})}function initImageModal(){const e=document.getElementById("imageModal"),t=document.getElementById("modalImage"),o=document.querySelector(".modal .close");if(!e||!t||!o)return;document.querySelectorAll(".reader-images img").forEach(o=>{o.addEventListener("click",()=>{e.style.display="flex",t.src=o.src})});const n=()=>{e.style.display="none"};o.addEventListener("click",n),e.addEventListener("click",e=>{e.target===e&&n()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&e.style.display==="flex"&&n()})}function initChapterToggle(){const e=document.getElementById("chapterToggleBtn"),t=document.querySelector(".chapter-list");e&&t&&(t.querySelectorAll("li").length>15&&(e.style.display="inline-block",t.classList.add("collapsed")),e.addEventListener("click",()=>{t.classList.toggle("collapsed"),e.textContent=t.classList.contains("collapsed")?"Tampilkan Semua Chapter":"Ciutkan Daftar"}))}

